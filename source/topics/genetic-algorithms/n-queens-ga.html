

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>8. \(n\) Queens Genetic Algorithm &mdash; CSCI 340 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=fa70396c" />

  
    <link rel="shortcut icon" href="../../_static/duck_face.ico"/>
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=f2a433a1"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="9. Experimenting with the \(n\) Queens Genetic Algorithm" href="n-queens-ga-experiment.html" />
    <link rel="prev" title="7. Representation" href="../representation/representation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            CSCI 340
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Course Notes</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro/intro.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="simple-ga.html">2. Implementing a Genetic Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="simple-ga-experiment.html">3. Experimenting with a Genetic Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../problems/problems.html">4. Problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../origin/origin.html">5. Origin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/overview.html">6. Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../representation/representation.html">7. Representation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">8. <span class="math notranslate nohighlight">\(n\)</span> Queens Genetic Algorithm</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#problem">8.1. Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="#initialization">8.2. Initialization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#representation">8.2.1. Representation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#population">8.2.2. Population</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#evaluation">8.3. Evaluation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#selection">8.4. Selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="#variation-operators">8.5. Variation Operators</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#crossover">8.5.1. Crossover</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mutation">8.5.2. Mutation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#termination-requirement">8.6. Termination Requirement</a></li>
<li class="toctree-l2"><a class="reference internal" href="#for-next-class">8.7. For Next Class</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="n-queens-ga-experiment.html">9. Experimenting with the <span class="math notranslate nohighlight">\(n\)</span> Queens Genetic Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../genetic-operators/genetic-operators.html">10. Genetic Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../selection/selection.html">11. Selection and Population Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../genetic-programming/genetic-programming.html">12. Genetic Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="../genetic-programming/symbolic-regression-gp.html">13. Symbolic Regression with Genetic Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="../genetic-programming/symbolic-regression-gp-experiment.html">14. Experimenting with Symbolic Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parameters/tuning.html">15. Tuning Hyperparameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parameters/comparing.html">16. What Comparing Distributions <em>Means</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="../problems/multi-objective.html">17. Multi-Objective Problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../particle-swarm-optimization/pso.html">18. Particle Swarm Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../particle-swarm-optimization/simple-pso.html">19. Implementing PSO</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Student Lectures</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../student-lectures/description.html">1. Student Lecture Task Description</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../student-lectures/Ant%20Colony%20Optimization/Ant%20Colony%20Optimization.html">2. Ant Colony Optimization (ACO)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Student Projects</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../student-projects/description.html">1. Project Description</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Assignments</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../assignments/tsp/tsp.html">1. Travelling Salesperson Problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../assignments/gp/gp.html">2. Genetic Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../assignments/pso/pso.html">3. Particle Swarm Optimization</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Outline</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../outline/outline.html">Computer Science 340 — Evolutionary Computation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">CSCI 340</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active"><span class="section-number">8. </span><span class="math notranslate nohighlight">\(n\)</span> Queens Genetic Algorithm</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/topics/genetic-algorithms/n-queens-ga.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="n-queens-genetic-algorithm">
<h1><span class="section-number">8. </span><span class="math notranslate nohighlight">\(n\)</span> Queens Genetic Algorithm<a class="headerlink" href="#n-queens-genetic-algorithm" title="Link to this heading"></a></h1>
<ul class="simple">
<li><p>The purpose of this topic is to emphasize the similarities between genetic algorithm implementations</p></li>
<li><p>Although the first genetic algorithm implementation was solving a different problem, much of the algorithm is the same</p></li>
</ul>
<section id="problem">
<h2><span class="section-number">8.1. </span>Problem<a class="headerlink" href="#problem" title="Link to this heading"></a></h2>
<ul>
<li><p>The optimization version of the <span class="math notranslate nohighlight">\(n\)</span> queens problem is going to be used</p>
<blockquote>
<div><ul class="simple">
<li><p>Given an <span class="math notranslate nohighlight">\(n \times n\)</span> chess board</p></li>
<li><p>Place <span class="math notranslate nohighlight">\(n\)</span> queens on the chess board</p></li>
<li><p>While minimizing the number of conflicting/attacking queens</p></li>
</ul>
</div></blockquote>
</li>
<li><p>In other words, minimize the number of queens in the same row, column, or diagonal</p></li>
</ul>
<figure class="align-center" id="id1">
<a class="reference external image-reference" href="https://en.wikipedia.org/wiki/Eight_queens_puzzle"><img alt="../../_images/10_queens.png" src="../../_images/10_queens.png" style="width: 300px;" /></a>
<figcaption>
<p><span class="caption-text">A configuration of <span class="math notranslate nohighlight">\(10\)</span> queens on a <span class="math notranslate nohighlight">\(10 \times 10\)</span> chess board with zero conflicts. This would be an
optimal solution where <span class="math notranslate nohighlight">\(n=10\)</span>.</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<ul>
<li><p>The reason the optimization version of the problem is being used is because it has a gradient for the search to follow</p></li>
<li><p>The all or nothing (valid configuration or not) version of the problem has no gradient</p></li>
<li><p>The phenotype space (problem space) includes all possible configurations of the <span class="math notranslate nohighlight">\(n\)</span> queens on an <span class="math notranslate nohighlight">\(n \times n\)</span> board</p>
<blockquote>
<div><ul class="simple">
<li><p>Assuming queens are not allowed on the same square, this is <span class="math notranslate nohighlight">\(n \times n \choose n\)</span></p></li>
</ul>
</div></blockquote>
</li>
<li><p>However, as previously discussed, by using a permutation encoding, the genotype space (search space) is only <span class="math notranslate nohighlight">\(n!\)</span></p></li>
</ul>
</section>
<section id="initialization">
<h2><span class="section-number">8.2. </span>Initialization<a class="headerlink" href="#initialization" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Before evolution can begin, an initial population of candidate solutions</p></li>
</ul>
<section id="representation">
<h3><span class="section-number">8.2.1. </span>Representation<a class="headerlink" href="#representation" title="Link to this heading"></a></h3>
<ul>
<li><p>The permutation representation previously discussed will be used</p>
<blockquote>
<div><ul class="simple">
<li><p>A chromosome will be a list of length <span class="math notranslate nohighlight">\(n\)</span></p></li>
<li><p>Each of the <span class="math notranslate nohighlight">\(n\)</span> indices correspond to each of the <span class="math notranslate nohighlight">\(n\)</span> queens</p></li>
<li><p>Each index will be the queen’s respective column in the chess board</p></li>
<li><p>The elements within the list will be a permutation of the integers between <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(n-1\)</span></p></li>
<li><p>The value at each index will be the queen’s respective row in the chess board</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Since the values and indices are unique, no two queens can be in the same row or column</p></li>
<li><p>An example chromosome when <span class="math notranslate nohighlight">\(n=8\)</span> is</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">&lt;0,</span> <span class="pre">5,</span> <span class="pre">7,</span> <span class="pre">6,</span> <span class="pre">3,</span> <span class="pre">2,</span> <span class="pre">1,</span> <span class="pre">4&gt;</span></code></p>
</div></blockquote>
</li>
</ul>
</section>
<section id="population">
<h3><span class="section-number">8.2.2. </span>Population<a class="headerlink" href="#population" title="Link to this heading"></a></h3>
<ul>
<li><p>A population is a list of chromosomes</p>
<blockquote>
<div><div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[&lt;0, 5, 7, 6, 3, 2, 1, 4&gt;,
 &lt;4, 5, 2, 3, 6, 7, 1, 0&gt;,
 &lt;0, 1, 2, 3, 4, 5, 6, 7&gt;,
 ...
 ...
 &lt;4, 3, 2, 7, 6, 1, 0, 5&gt;]
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>The chromosomes, and thus the population, will be randomly generated for this implementation of a genetic algorithm</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">48</span>    <span class="n">population</span> <span class="o">=</span> <span class="p">[]</span>
<span class="linenos">49</span>    <span class="n">population_fitness</span> <span class="o">=</span> <span class="p">[]</span>
<span class="linenos">50</span>    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">POPULATION_SIZE</span><span class="p">):</span>
<span class="linenos">51</span>        <span class="n">chromosome</span> <span class="o">=</span> <span class="n">sample</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">N_QUEENS</span><span class="p">),</span> <span class="n">k</span><span class="o">=</span><span class="n">N_QUEENS</span><span class="p">)</span>
<span class="linenos">52</span>        <span class="n">population</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chromosome</span><span class="p">)</span>
</pre></div>
</div>
<ul>
<li><p>The number of chromosomes within the population is defined by a hyperparameter called <code class="docutils literal notranslate"><span class="pre">POPULATION_SIZE</span></code></p></li>
<li><p>The length of the chromosomes will match the number of queens, which is defined by the hyperparameter <code class="docutils literal notranslate"><span class="pre">N_QUEENS</span></code></p></li>
<li><p>The chromosomes are permutations of the sequence of integers from <span class="math notranslate nohighlight">\(0\)</span> to <span class="math notranslate nohighlight">\(n-1\)</span></p></li>
<li><p>Note that <code class="docutils literal notranslate"><span class="pre">sample</span></code> is from Python’s <code class="docutils literal notranslate"><span class="pre">random</span></code> library</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/random.html#random.sample">It returns a k length list of unique elements chosen from a population sequence</a></p></li>
</ul>
</div></blockquote>
</li>
</ul>
</section>
</section>
<section id="evaluation">
<h2><span class="section-number">8.3. </span>Evaluation<a class="headerlink" href="#evaluation" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>The fitness function will count the number of conflicting queens</p></li>
<li><p>Each pair of conflicting queens will only be counted once</p></li>
<li><p>With the representation used, it’s not possible for two queens to be in the same row or column</p></li>
<li><p>Thus, only the diagonals need to be checked</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">23</span><span class="k">def</span> <span class="nf">attacking_fitness</span><span class="p">(</span><span class="n">chromosome</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="linenos">24</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">25</span><span class="sd">    Count the number of attacking queens in the provided queen placements. To count each attacking pair only once, the</span>
<span class="linenos">26</span><span class="sd">    check for attacking only happens in the forward direction (from index 0 towards n). With the permutation</span>
<span class="linenos">27</span><span class="sd">    representation, attacking can only happen in a diagonal, thus the check for attacking is to check only +/- offset,</span>
<span class="linenos">28</span><span class="sd">    where offset is the number of indices away the queens are from each other. For example, consider the chromosome</span>
<span class="linenos">29</span><span class="sd">    [?, ?, 4, 3, 6, 1, ?, ?]. The queen at index 2 is attacking 3 queens: it attacks the queen at index 3 as it is</span>
<span class="linenos">30</span><span class="sd">    offset 1 and 4-1=3, it is attacking the queen at index 4 as it is offset 2 and 4+2=6, and it is attacking the queen</span>
<span class="linenos">31</span><span class="sd">    at index 5 as it is offset 3 and 4-3=1.</span>
<span class="linenos">32</span>
<span class="linenos">33</span><span class="sd">    :param chromosome: Chromosome (queen placements) to evaluate</span>
<span class="linenos">34</span><span class="sd">    :return: The number of attacking queens.</span>
<span class="linenos">35</span><span class="sd">    &quot;&quot;&quot;</span>
<span class="linenos">36</span>    <span class="n">total_attackers</span> <span class="o">=</span> <span class="mi">0</span>
<span class="linenos">37</span>    <span class="k">for</span> <span class="n">attacker_column</span><span class="p">,</span> <span class="n">attacker_row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">chromosome</span><span class="p">):</span>
<span class="linenos">38</span>        <span class="k">for</span> <span class="n">victim_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">attacker_column</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">chromosome</span><span class="p">)):</span>
<span class="linenos">39</span>            <span class="n">offset</span> <span class="o">=</span> <span class="n">victim_index</span> <span class="o">-</span> <span class="n">attacker_column</span>
<span class="linenos">40</span>            <span class="n">victim_row</span> <span class="o">=</span> <span class="n">chromosome</span><span class="p">[</span><span class="n">victim_index</span><span class="p">]</span>
<span class="linenos">41</span>            <span class="k">if</span> <span class="p">(</span><span class="n">attacker_row</span> <span class="o">-</span> <span class="n">offset</span><span class="p">)</span> <span class="o">==</span> <span class="n">victim_row</span> <span class="ow">or</span> <span class="p">(</span><span class="n">attacker_row</span> <span class="o">+</span> <span class="n">offset</span><span class="p">)</span> <span class="o">==</span> <span class="n">victim_row</span><span class="p">:</span>
<span class="linenos">42</span>                <span class="n">total_attackers</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="linenos">43</span>    <span class="k">return</span> <span class="n">total_attackers</span>
</pre></div>
</div>
<ul>
<li><p>For each queen, check the up and down diagonals to the right</p>
<blockquote>
<div><ul class="simple">
<li><p>There is no need to check to the left as any conflict to the left would already be counted</p></li>
</ul>
</div></blockquote>
</li>
<li><p>The basic idea here is</p>
<blockquote>
<div><ul class="simple">
<li><p>Given a queen at index <code class="docutils literal notranslate"><span class="pre">attacker_column</span></code> with value <code class="docutils literal notranslate"><span class="pre">attacker_row</span></code></p></li>
<li><p>In order for a queen <code class="docutils literal notranslate"><span class="pre">offset</span></code> indices away with the value <code class="docutils literal notranslate"><span class="pre">victim_row</span></code> to be in the same diagonal</p></li>
<li><p>The value of <code class="docutils literal notranslate"><span class="pre">victim_row</span></code> <strong>must</strong> be equal to <code class="docutils literal notranslate"><span class="pre">attacker_row</span> <span class="pre">-</span> <span class="pre">offset</span></code> or <code class="docutils literal notranslate"><span class="pre">attacker_row</span> <span class="pre">+</span> <span class="pre">offset</span></code></p></li>
</ul>
</div></blockquote>
</li>
</ul>
<figure class="align-center" id="id2">
<a class="reference external image-reference" href="https://en.wikipedia.org/wiki/Eight_queens_puzzle"><img alt="../../_images/8_queens_conflicts.png" src="../../_images/8_queens_conflicts.png" style="width: 250px;" /></a>
<figcaption>
<p><span class="caption-text"><span class="math notranslate nohighlight">\(8 \times 8\)</span> chess board configuration with 4 conflicts. Only <span class="math notranslate nohighlight">\(5\)</span> queens are shown here for
demonstration purposes.</span><a class="headerlink" href="#id2" title="Link to this image"></a></p>
</figcaption>
</figure>
<ul>
<li><p>Consider the above figure and the chromosome <code class="docutils literal notranslate"><span class="pre">&lt;?,</span> <span class="pre">6,</span> <span class="pre">3,</span> <span class="pre">4,</span> <span class="pre">0,</span> <span class="pre">?,</span> <span class="pre">1,</span> <span class="pre">?&gt;</span></code></p>
<blockquote>
<div><ul class="simple">
<li><p>The question marks represent irrelevant values for this example</p></li>
</ul>
</div></blockquote>
</li>
<li><p>When evaluating the queens from left to right</p>
<blockquote>
<div><ul>
<li><p>The queen at index <code class="docutils literal notranslate"><span class="pre">1</span></code> has a value of <code class="docutils literal notranslate"><span class="pre">6</span></code> and conflicts with two queens</p>
<blockquote>
<div><ul>
<li><p>It conflicts with the queen at index <code class="docutils literal notranslate"><span class="pre">3</span></code></p>
<blockquote>
<div><ul class="simple">
<li><p>The offset is <code class="docutils literal notranslate"><span class="pre">2</span></code> and the value at index <code class="docutils literal notranslate"><span class="pre">1</span></code> equals the value at index <code class="docutils literal notranslate"><span class="pre">3</span></code> minus the offset <code class="docutils literal notranslate"><span class="pre">2</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">6</span> <span class="pre">-</span> <span class="pre">2</span> <span class="pre">==</span> <span class="pre">4</span></code></p></li>
</ul>
</div></blockquote>
</li>
<li><p>It also conflicts with the queen at index <code class="docutils literal notranslate"><span class="pre">6</span></code></p>
<blockquote>
<div><ul class="simple">
<li><p>The offset is <code class="docutils literal notranslate"><span class="pre">5</span></code> and the value at index <code class="docutils literal notranslate"><span class="pre">6</span></code> equals the value at index <code class="docutils literal notranslate"><span class="pre">6</span></code> minus the offset <code class="docutils literal notranslate"><span class="pre">5</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">6</span> <span class="pre">-</span> <span class="pre">5</span> <span class="pre">==</span> <span class="pre">1</span></code></p></li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</li>
<li><p>The queen at index <code class="docutils literal notranslate"><span class="pre">2</span></code> also has a conflict with the queen at index <code class="docutils literal notranslate"><span class="pre">3</span></code></p>
<blockquote>
<div><ul class="simple">
<li><p>The offset is <code class="docutils literal notranslate"><span class="pre">1</span></code> and the value at index <code class="docutils literal notranslate"><span class="pre">2</span></code> equals the vlaue at index <code class="docutils literal notranslate"><span class="pre">3</span></code> plus the offset <code class="docutils literal notranslate"><span class="pre">1</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">3</span> <span class="pre">+</span> <span class="pre">1</span> <span class="pre">==</span> <span class="pre">4</span></code></p></li>
</ul>
</div></blockquote>
</li>
<li><p>Lastly, the queen at index <code class="docutils literal notranslate"><span class="pre">3</span></code> conflicts with the queen at index <code class="docutils literal notranslate"><span class="pre">6</span></code></p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">4</span>&#160; <span class="pre">-</span> <span class="pre">3</span> <span class="pre">==</span> <span class="pre">1</span></code></p></li>
</ul>
</div></blockquote>
</li>
<li><p>As mentioned above, there is no need to look to the left of any queen as those conflicts would already be counted</p>
<blockquote>
<div><ul class="simple">
<li><p>For example, the queen at index <code class="docutils literal notranslate"><span class="pre">6</span></code>s conflicts were already counted</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</li>
<li><p>With this fitness function, the fitness of each candidate solution within the population can be calculated and stored</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">58</span>        <span class="n">population_fitness</span> <span class="o">=</span> <span class="p">[]</span>
<span class="linenos">59</span>        <span class="k">for</span> <span class="n">chromosome</span> <span class="ow">in</span> <span class="n">population</span><span class="p">:</span>
<span class="linenos">60</span>            <span class="n">fitness</span> <span class="o">=</span> <span class="n">attacking_fitness</span><span class="p">(</span><span class="n">chromosome</span><span class="p">)</span>
<span class="linenos">61</span>            <span class="n">population_fitness</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fitness</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="selection">
<h2><span class="section-number">8.4. </span>Selection<a class="headerlink" href="#selection" title="Link to this heading"></a></h2>
<ul>
<li><p>Tournament selection will be used here</p>
<blockquote>
<div><ul class="simple">
<li><p>It’s simple, and effective</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">65</span>        <span class="n">mating_pool</span> <span class="o">=</span> <span class="p">[]</span>
<span class="linenos">66</span>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">POPULATION_SIZE</span><span class="p">):</span>
<span class="linenos">67</span>            <span class="n">tournament_indices</span> <span class="o">=</span> <span class="n">choices</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">POPULATION_SIZE</span><span class="p">),</span> <span class="n">k</span><span class="o">=</span><span class="n">TOURNAMENT_SIZE</span><span class="p">)</span>
<span class="linenos">68</span>            <span class="n">chromosome</span> <span class="o">=</span> <span class="n">tournament_selection</span><span class="p">(</span><span class="n">population</span><span class="p">,</span> <span class="n">population_fitness</span><span class="p">,</span> <span class="n">tournament_indices</span><span class="p">,</span> <span class="n">direction</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos">69</span>            <span class="n">mating_pool</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chromosome</span><span class="p">)</span>
</pre></div>
</div>
<ul>
<li><p>Mind the use of the argument <code class="docutils literal notranslate"><span class="pre">direction</span></code></p>
<blockquote>
<div><ul class="simple">
<li><p>This indicates that chromosomes with <em>lower</em> fitness values are better</p></li>
<li><p>By default it assumes higher fitness is better</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">23</span><span class="k">def</span> <span class="nf">tournament_selection</span><span class="p">(</span>
<span class="linenos">24</span>    <span class="n">population</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">population_fitness</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">selected_indices</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">direction</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
<span class="linenos">25</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="linenos">26</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">27</span><span class="sd">    Select the chromosome with the maximum/minimum fitness value of the chromosomes in the tournament. The chromosomes</span>
<span class="linenos">28</span><span class="sd">    in the tournament if its index is contained within the selected_indices list. By default, the function selects for</span>
<span class="linenos">29</span><span class="sd">    maximum fitness.</span>
<span class="linenos">30</span>
<span class="linenos">31</span><span class="sd">    :param population: Population of chromosomes to select from</span>
<span class="linenos">32</span><span class="sd">    :param population_fitness: Fitness values of the population</span>
<span class="linenos">33</span><span class="sd">    :param selected_indices: List of indices in the tournament</span>
<span class="linenos">34</span><span class="sd">    :param direction: +1 for maximizing fitness, -1 for minimizing fitness</span>
<span class="linenos">35</span><span class="sd">    :return: A copy of the selected chromosome</span>
<span class="linenos">36</span><span class="sd">    :raises ValueError: If the list of selected indices is empty or contains an out-of-bounds index</span>
<span class="linenos">37</span><span class="sd">    &quot;&quot;&quot;</span>
<span class="linenos">38</span>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selected_indices</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="linenos">39</span>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;List of indices in the tournament must be non empty: </span><span class="si">{</span><span class="n">selected_indices</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos">40</span>    <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">selected_indices</span><span class="p">:</span>
<span class="linenos">41</span>        <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">index</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">population_fitness</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
<span class="linenos">42</span>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;List of indices in the tournament contains out-of-bounds index: </span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos">43</span>    <span class="n">max_value</span> <span class="o">=</span> <span class="n">population_fitness</span><span class="p">[</span><span class="n">selected_indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">*</span> <span class="n">direction</span>
<span class="linenos">44</span>    <span class="n">max_index</span> <span class="o">=</span> <span class="n">selected_indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="linenos">45</span>    <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">selected_indices</span><span class="p">:</span>
<span class="linenos">46</span>        <span class="k">if</span> <span class="n">population_fitness</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">*</span> <span class="n">direction</span> <span class="o">&gt;</span> <span class="n">max_value</span><span class="p">:</span>
<span class="linenos">47</span>            <span class="n">max_value</span> <span class="o">=</span> <span class="n">population_fitness</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">*</span> <span class="n">direction</span>
<span class="linenos">48</span>            <span class="n">max_index</span> <span class="o">=</span> <span class="n">index</span>
<span class="linenos">49</span>    <span class="k">return</span> <span class="n">population</span><span class="p">[</span><span class="n">max_index</span><span class="p">][:]</span>
</pre></div>
</div>
</section>
<section id="variation-operators">
<h2><span class="section-number">8.5. </span>Variation Operators<a class="headerlink" href="#variation-operators" title="Link to this heading"></a></h2>
<ul>
<li><p>Given the permutation representation, special considerations should be made when implementing the variation operators</p></li>
<li><p>The operators should ensure the chromosome remain a permutation</p>
<blockquote>
<div><ul class="simple">
<li><p>Consider a one point crossover on permutations</p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>       v                    v
[0, 1, 2, 3, 4]      [0, 1, 2, 1, 0]
                 -&gt;
[4, 3, 2, 1, 0]      [4, 3, 2, 3, 4]
       ^                    ^
</pre></div>
</div>
<ul class="simple">
<li><p>This crossover may destroy the fact that the chromosomes are permutations</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<section id="crossover">
<h3><span class="section-number">8.5.1. </span>Crossover<a class="headerlink" href="#crossover" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>An <em>order crossover</em> is commonly used for permutation representations</p></li>
<li><p>Keep all elements between two randomly selected indices</p></li>
</ul>
<figure class="align-center" id="id3">
<a class="reference internal image-reference" href="../../_images/order_crossover_copy.png"><img alt="../../_images/order_crossover_copy.png" src="../../_images/order_crossover_copy.png" style="width: 500px;" /></a>
<figcaption>
<p><span class="caption-text">Keep the segment of the chromosome between two arbitrarily selected indices. This only shows one of the two children
that this crossover would produce.</span><a class="headerlink" href="#id3" title="Link to this image"></a></p>
</figcaption>
</figure>
<ul>
<li><p>Then, copy the elements from chromosome <span class="math notranslate nohighlight">\(A\)</span>, in order, if they do <em>not</em> appear in chromosome <span class="math notranslate nohighlight">\(B\)</span></p>
<blockquote>
<div><ul class="simple">
<li><p>Start copying from <em>after</em> the kept segment</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<figure class="align-center" id="id4">
<a class="reference internal image-reference" href="../../_images/order_crossover_remaining.png"><img alt="../../_images/order_crossover_remaining.png" src="../../_images/order_crossover_remaining.png" style="width: 500px;" /></a>
<figcaption>
<p><span class="caption-text">Copy the elements from the other parent, in order, starting after the kept segment. Only copy values that are not
already contained within the child. Again, this only shows one of the two children this crossover would produce.</span><a class="headerlink" href="#id4" title="Link to this image"></a></p>
</figcaption>
</figure>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">def</span> <span class="nf">order_crossover</span><span class="p">(</span><span class="n">parent_1</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">parent_2</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
<span class="linenos"> 2</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 3</span><span class="sd">    Order crossover. All elements between the two indices are moved to the children and the remaining missing elements</span>
<span class="linenos"> 4</span><span class="sd">    are copied in the order that they appear in the other parent. Copying starts at end_index and returns to index zero</span>
<span class="linenos"> 5</span><span class="sd">    when the end of the chromosome is hit. For example, indices of 2 and 5, [0,1,2,3,4,5,6], [4,6,3,5,2,0,1] -&gt;</span>
<span class="linenos"> 6</span><span class="sd">    [?,?,2,3,4,?,?], [?,?,3,5,2,?,?] -&gt; [6,5,2,3,4,0,1], [1,4,3,5,2,6,0]. Out of order indices, indices with a</span>
<span class="linenos"> 7</span><span class="sd">    difference of 0, and indices covering the whole length of the chromosome are allowed, but result in no change.</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="sd">    :param parent_1: Chromosome to be used in crossover</span>
<span class="linenos">10</span><span class="sd">    :param parent_2: Chromosome to be used in crossover</span>
<span class="linenos">11</span><span class="sd">    :param start_index: Starting index of copied segment</span>
<span class="linenos">12</span><span class="sd">    :param end_index: Ending index of copied segment (excluded in segment)</span>
<span class="linenos">13</span><span class="sd">    :return: The two chromosomes after the crossover is applied</span>
<span class="linenos">14</span><span class="sd">    :raises ValueError: If the parents are not the same length of if an index is out-of-bounds</span>
<span class="linenos">15</span><span class="sd">    &quot;&quot;&quot;</span>
<span class="linenos">16</span>
<span class="linenos">17</span>    <span class="k">def</span> <span class="nf">copy_missing_elements</span><span class="p">(</span><span class="n">parent</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">child</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="linenos">18</span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">19</span><span class="sd">        Copy the missing elements from the other parent into the child. Elements are copied in order that they appear</span>
<span class="linenos">20</span><span class="sd">        in the parent, starting at the end index, and looping to index 0 where necessary.</span>
<span class="linenos">21</span>
<span class="linenos">22</span><span class="sd">        :param parent: Chromosome to copy missing elements from</span>
<span class="linenos">23</span><span class="sd">        :param child: Chromosome to have missing elements copied too</span>
<span class="linenos">24</span><span class="sd">        :param start_index: Starting index of copied segment (where to stop copying missing elements to)</span>
<span class="linenos">25</span><span class="sd">        :param end_index: Ending index of copied segment (where to start copying missing elements from)</span>
<span class="linenos">26</span><span class="sd">        :return: child chromosome with the missing elements copied</span>
<span class="linenos">27</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">28</span>        <span class="n">source_index</span> <span class="o">=</span> <span class="n">end_index</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">parent_1</span><span class="p">)</span>
<span class="linenos">29</span>        <span class="n">target_index</span> <span class="o">=</span> <span class="n">end_index</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">parent_1</span><span class="p">)</span>
<span class="linenos">30</span>        <span class="k">while</span> <span class="n">target_index</span> <span class="o">!=</span> <span class="n">start_index</span><span class="p">:</span>
<span class="linenos">31</span>            <span class="k">if</span> <span class="n">parent</span><span class="p">[</span><span class="n">source_index</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">child</span><span class="p">[</span><span class="n">start_index</span><span class="p">:</span><span class="n">end_index</span><span class="p">]:</span>
<span class="linenos">32</span>                <span class="n">child</span><span class="p">[</span><span class="n">target_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">parent</span><span class="p">[</span><span class="n">source_index</span><span class="p">]</span>
<span class="linenos">33</span>                <span class="n">target_index</span> <span class="o">=</span> <span class="p">(</span><span class="n">target_index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">parent_1</span><span class="p">)</span>
<span class="linenos">34</span>            <span class="n">source_index</span> <span class="o">=</span> <span class="p">(</span><span class="n">source_index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">parent_1</span><span class="p">)</span>
<span class="linenos">35</span>        <span class="k">return</span> <span class="n">child</span>
<span class="linenos">36</span>
<span class="linenos">37</span>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parent_1</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">parent_2</span><span class="p">):</span>
<span class="linenos">38</span>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;chromosomes must be the same length: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">parent_1</span><span class="p">)</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">parent_2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos">39</span>    <span class="k">if</span> <span class="n">start_index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">end_index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">start_index</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">parent_1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">end_index</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">parent_1</span><span class="p">):</span>
<span class="linenos">40</span>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Index out-of-bounds: </span><span class="si">{</span><span class="n">start_index</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">end_index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos">41</span>    <span class="n">child_1</span> <span class="o">=</span> <span class="n">parent_1</span><span class="p">[:]</span>
<span class="linenos">42</span>    <span class="n">child_2</span> <span class="o">=</span> <span class="n">parent_2</span><span class="p">[:]</span>
<span class="linenos">43</span>    <span class="k">if</span> <span class="n">start_index</span> <span class="o">&gt;</span> <span class="n">end_index</span><span class="p">:</span>
<span class="linenos">44</span>        <span class="k">return</span> <span class="n">child_1</span><span class="p">,</span> <span class="n">child_2</span>
<span class="linenos">45</span>    <span class="n">child_1</span> <span class="o">=</span> <span class="n">copy_missing_elements</span><span class="p">(</span><span class="n">parent_2</span><span class="p">,</span> <span class="n">child_1</span><span class="p">,</span> <span class="n">start_index</span><span class="p">,</span> <span class="n">end_index</span><span class="p">)</span>
<span class="linenos">46</span>    <span class="n">child_2</span> <span class="o">=</span> <span class="n">copy_missing_elements</span><span class="p">(</span><span class="n">parent_1</span><span class="p">,</span> <span class="n">child_2</span><span class="p">,</span> <span class="n">start_index</span><span class="p">,</span> <span class="n">end_index</span><span class="p">)</span>
<span class="linenos">47</span>    <span class="k">return</span> <span class="n">child_1</span><span class="p">,</span> <span class="n">child_2</span>
</pre></div>
</div>
</section>
<section id="mutation">
<h3><span class="section-number">8.5.2. </span>Mutation<a class="headerlink" href="#mutation" title="Link to this heading"></a></h3>
<ul>
<li><p>Similar to crossover, one must be careful with the choice of mutation when working with permutations</p></li>
<li><p>Fortunately, swap mutation is a very simple mutation that is permutation safe</p>
<blockquote>
<div><ul class="simple">
<li><p>Select two indices and swap the values between them</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<figure class="align-center" id="id5">
<a class="reference internal image-reference" href="../../_images/swap_mutation.png"><img alt="../../_images/swap_mutation.png" src="../../_images/swap_mutation.png" style="width: 500px;" /></a>
<figcaption>
<p><span class="caption-text">Swap mutation on some chromosome. The values at indices <code class="docutils literal notranslate"><span class="pre">1</span></code> and <code class="docutils literal notranslate"><span class="pre">4</span></code> are swapped in this example.</span><a class="headerlink" href="#id5" title="Link to this image"></a></p>
</figcaption>
</figure>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">38</span><span class="k">def</span> <span class="nf">swap_mutation</span><span class="p">(</span><span class="n">parent</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">index_1</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">index_2</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="linenos">39</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">40</span><span class="sd">    Swap mutation. Swap the values between the two specified indices. For example, with swap indices of 0 and 3,</span>
<span class="linenos">41</span><span class="sd">    [0, 1, 2, 3, 4] -&gt; [3, 1, 2, 0, 4]. Providing the same index for both index values results in no change.</span>
<span class="linenos">42</span>
<span class="linenos">43</span><span class="sd">    :param parent: Chromosome to be mutated</span>
<span class="linenos">44</span><span class="sd">    :param index_1: Index to be swapped with index_2</span>
<span class="linenos">45</span><span class="sd">    :param index_2: Index to be swapped with index_1</span>
<span class="linenos">46</span><span class="sd">    :return: The chromosome after the mutation is applied</span>
<span class="linenos">47</span><span class="sd">    :raises ValueError: If either index is out-of-bounds</span>
<span class="linenos">48</span><span class="sd">    &quot;&quot;&quot;</span>
<span class="linenos">49</span>    <span class="k">if</span> <span class="n">index_1</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">index_2</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">index_1</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">index_2</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
<span class="linenos">50</span>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Index out-of-bounds: </span><span class="si">{</span><span class="n">index_1</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">index_2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos">51</span>    <span class="n">child</span> <span class="o">=</span> <span class="n">parent</span><span class="p">[:]</span>
<span class="linenos">52</span>    <span class="n">child</span><span class="p">[</span><span class="n">index_1</span><span class="p">],</span> <span class="n">child</span><span class="p">[</span><span class="n">index_2</span><span class="p">]</span> <span class="o">=</span> <span class="n">child</span><span class="p">[</span><span class="n">index_2</span><span class="p">],</span> <span class="n">child</span><span class="p">[</span><span class="n">index_1</span><span class="p">]</span>
<span class="linenos">53</span>    <span class="k">return</span> <span class="n">child</span>
</pre></div>
</div>
</section>
</section>
<section id="termination-requirement">
<h2><span class="section-number">8.6. </span>Termination Requirement<a class="headerlink" href="#termination-requirement" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>A generational GA will be used with a pre set number of generations defined by the hyperparameter <code class="docutils literal notranslate"><span class="pre">GENERATIONS</span></code></p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">56</span>    <span class="k">for</span> <span class="n">generation</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">GENERATIONS</span><span class="p">):</span>
<span class="linenos">57</span>        <span class="c1"># [begin-evaluation]</span>
<span class="linenos">58</span>        <span class="n">population_fitness</span> <span class="o">=</span> <span class="p">[]</span>
<span class="linenos">59</span>        <span class="k">for</span> <span class="n">chromosome</span> <span class="ow">in</span> <span class="n">population</span><span class="p">:</span>
<span class="linenos">60</span>            <span class="n">fitness</span> <span class="o">=</span> <span class="n">attacking_fitness</span><span class="p">(</span><span class="n">chromosome</span><span class="p">)</span>
<span class="linenos">61</span>            <span class="n">population_fitness</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fitness</span><span class="p">)</span>
<span class="linenos">62</span>        <span class="c1"># [end-evaluation]</span>
<span class="linenos">63</span>
<span class="linenos">64</span>        <span class="c1"># [begin-selection]</span>
<span class="linenos">65</span>        <span class="n">mating_pool</span> <span class="o">=</span> <span class="p">[]</span>
<span class="linenos">66</span>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">POPULATION_SIZE</span><span class="p">):</span>
<span class="linenos">67</span>            <span class="n">tournament_indices</span> <span class="o">=</span> <span class="n">choices</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">POPULATION_SIZE</span><span class="p">),</span> <span class="n">k</span><span class="o">=</span><span class="n">TOURNAMENT_SIZE</span><span class="p">)</span>
<span class="linenos">68</span>            <span class="n">chromosome</span> <span class="o">=</span> <span class="n">tournament_selection</span><span class="p">(</span><span class="n">population</span><span class="p">,</span> <span class="n">population_fitness</span><span class="p">,</span> <span class="n">tournament_indices</span><span class="p">,</span> <span class="n">direction</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos">69</span>            <span class="n">mating_pool</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chromosome</span><span class="p">)</span>
<span class="linenos">70</span>        <span class="c1"># [end-selection]</span>
<span class="linenos">71</span>
<span class="linenos">72</span>        <span class="c1"># [begin-crossover]</span>
<span class="linenos">73</span>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">POPULATION_SIZE</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
<span class="linenos">74</span>            <span class="k">if</span> <span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">CROSSOVER_RATE</span><span class="p">:</span>
<span class="linenos">75</span>                <span class="n">index_one</span> <span class="o">=</span> <span class="n">randrange</span><span class="p">(</span><span class="n">N_QUEENS</span><span class="p">)</span>
<span class="linenos">76</span>                <span class="n">index_two</span> <span class="o">=</span> <span class="n">randrange</span><span class="p">(</span><span class="n">N_QUEENS</span><span class="p">)</span>
<span class="linenos">77</span>                <span class="n">start_index</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">index_one</span><span class="p">,</span> <span class="n">index_two</span><span class="p">)</span>
<span class="linenos">78</span>                <span class="n">end_index</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">index_one</span><span class="p">,</span> <span class="n">index_two</span><span class="p">)</span>
<span class="linenos">79</span>                <span class="n">chromosome_1</span><span class="p">,</span> <span class="n">chromosome_2</span> <span class="o">=</span> <span class="n">order_crossover</span><span class="p">(</span><span class="n">mating_pool</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">mating_pool</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">start_index</span><span class="p">,</span> <span class="n">end_index</span><span class="p">)</span>
<span class="linenos">80</span>                <span class="n">mating_pool</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">chromosome_1</span>
<span class="linenos">81</span>                <span class="n">mating_pool</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">chromosome_2</span>
<span class="linenos">82</span>        <span class="c1"># [end-crossover]</span>
<span class="linenos">83</span>
<span class="linenos">84</span>        <span class="c1"># [begin-mutation]</span>
<span class="linenos">85</span>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">POPULATION_SIZE</span><span class="p">):</span>
<span class="linenos">86</span>            <span class="k">if</span> <span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">MUTATION_RATE</span><span class="p">:</span>
<span class="linenos">87</span>                <span class="n">index_one</span> <span class="o">=</span> <span class="n">randrange</span><span class="p">(</span><span class="n">N_QUEENS</span><span class="p">)</span>
<span class="linenos">88</span>                <span class="n">index_two</span> <span class="o">=</span> <span class="n">randrange</span><span class="p">(</span><span class="n">N_QUEENS</span><span class="p">)</span>
<span class="linenos">89</span>                <span class="n">chromosome</span> <span class="o">=</span> <span class="n">swap_mutation</span><span class="p">(</span><span class="n">mating_pool</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">index_one</span><span class="p">,</span> <span class="n">index_two</span><span class="p">)</span>
<span class="linenos">90</span>                <span class="n">mating_pool</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">chromosome</span>
<span class="linenos">91</span>        <span class="c1"># [end-mutation]</span>
<span class="linenos">92</span>
<span class="linenos">93</span>        <span class="n">population</span> <span class="o">=</span> <span class="n">mating_pool</span>
</pre></div>
</div>
<ul>
<li><p>This loop performs</p>
<blockquote>
<div><ul class="simple">
<li><p>Evaluation</p></li>
<li><p>Selection</p></li>
<li><p>Crossover</p></li>
<li><p>Mutation</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Once the loop runs to completion, some final results are calculated and reported</p>
<blockquote>
<div><ul class="simple">
<li><p>Calculate the final populations fitness</p></li>
<li><p>Report the population and the population’s fitness</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 97</span>    <span class="n">population_fitness</span> <span class="o">=</span> <span class="p">[]</span>
<span class="linenos"> 98</span>    <span class="k">for</span> <span class="n">chromosome</span> <span class="ow">in</span> <span class="n">population</span><span class="p">:</span>
<span class="linenos"> 99</span>        <span class="n">fitness</span> <span class="o">=</span> <span class="n">attacking_fitness</span><span class="p">(</span><span class="n">chromosome</span><span class="p">)</span>
<span class="linenos">100</span>        <span class="n">population_fitness</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fitness</span><span class="p">)</span>
<span class="linenos">101</span>    <span class="nb">print</span><span class="p">(</span><span class="n">population_fitness</span><span class="p">)</span>
<span class="linenos">102</span>    <span class="nb">print</span><span class="p">(</span><span class="n">population</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="for-next-class">
<h2><span class="section-number">8.7. </span>For Next Class<a class="headerlink" href="#for-next-class" title="Link to this heading"></a></h2>
<ul>
<li><p>Check out the following scripts</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference download internal" download="" href="../../_downloads/e1a90c967cc1c705d4e5537d0f4da751/selection.py"><code class="xref download docutils literal notranslate"><span class="pre">The</span> <span class="pre">Selection</span> <span class="pre">Script</span></code></a></p></li>
<li><p><a class="reference download internal" download="" href="../../_downloads/969dd0fa769f120fd7b02939736b2fc2/crossover.py"><code class="xref download docutils literal notranslate"><span class="pre">The</span> <span class="pre">Crossover</span> <span class="pre">Script</span></code></a></p></li>
<li><p><a class="reference download internal" download="" href="../../_downloads/3ff90bc7da7f0b62d9faef93bebb4fc4/mutation.py"><code class="xref download docutils literal notranslate"><span class="pre">The</span> <span class="pre">Mutation</span> <span class="pre">Script</span></code></a></p></li>
<li><p><a class="reference download internal" download="" href="../../_downloads/a54d104797d9e9f594031e3b31a4e48f/ga_n_queens.py"><code class="xref download docutils literal notranslate"><span class="pre">n</span> <span class="pre">Queens</span> <span class="pre">GA</span></code></a></p></li>
</ul>
</div></blockquote>
</li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../representation/representation.html" class="btn btn-neutral float-left" title="7. Representation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="n-queens-ga-experiment.html" class="btn btn-neutral float-right" title="9. Experimenting with the \(n\) Queens Genetic Algorithm" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, James Hughes &amp; Taras Mychaskiw.
      <span class="lastupdated">Last updated on Nov 17, 2024.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>